
<!doctype html>
<html>
<head>
	<title>I've beed iframed</title>
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TLKSDT9');</script>
<!-- test: GTM-5LX3TJL -->
<!-- smartfit GTM-TLKSDT9 -->
<!-- End Google Tag Manager -->
	
	<style>
		button {
			margin-bottom: 20px;
			margin-right: 20px;
			padding: 10px 5px;
		}
	</style>
</head>

<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TLKSDT9"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
I've beed iframed
<br/>
<button id="setup_context">setup_context</button>
<br/>
<button id="widget_loaded">widget_loaded</button>
<br/>
<button id="widget_opened">widget_opened</button>
<br/>
<button id="height_set">height_set</button>
<br/>
<button id="result_shown">result_shown</button>
	
<script>
window.dataLayer = window.dataLayer || [];

document.getElementById('setup_context').addEventListener('click',  function setup_context(){
 window.dataLayer.push({
'model_name': 'Model T',
'model_code': '(MTB) - Model T Black',
'location': 'www.parent.ts/model-t/?color=black&utm_source=narnia&utm_medium=magic&user=person',
'title': 'Model T title',
'hostname': 'www.parent.ts'
 });
});
//it is not possible to use window.parent.* in the frame thes data should come thru pipeline
	
document.getElementById('widget_loaded').addEventListener('click', function widget_loaded(){
 window.dataLayer.push({
 'event': 'widget_loaded',
'label': 'label_value_in_widget_loaded',
'eventLabel': 'eventLabelInWidgetLoaded',
'_label': '_labelInWidgetLoaded',
 });
});

document.getElementById('widget_opened').addEventListener('click', function widget_opened(){
window.dataLayer.push({
 'event': 'widget_opened'
 });
});
	
document.getElementById('height_set').addEventListener('click', function height_set(){
window.dataLayer.push({
'event': 'height_set',
'height': 175
 });
});
document.getElementById('result_shown').addEventListener('click', function result_shown(){

window.dataLayer.push({
 'event': 'result_shown'
 });
});
	
</script>
</body>
</html>


